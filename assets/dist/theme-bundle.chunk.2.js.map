{"version":3,"sources":["webpack:///./assets/js/theme/product.js","webpack:///./assets/js/theme/product/video-gallery.js","webpack:///./assets/js/theme/fulfillment-datepicker.js"],"names":["Product","context","url","window","location","href","$reviewLink","$","$bulkPricingLink","reviewModal","modalFactory","onReady","validator","setTimeout","FulfillmentDatepicker","document","on","indexOf","history","replaceState","title","pathname","collapsibleFactory","this","productDetails","ProductDetails","BCData","product_attributes","setProductVariant","videoGallery","bulkPricingHandler","$reviewForm","classifyForm","length","review","Review","registerValidation","ariaDescribeReviewInputs","performCheck","areAll","productReviewHandler","$form","find","each","_","input","$input","msgSpanId","attr","siblings","trigger","PageManager","VideoGallery","$element","$player","$videos","currentVideo","bindEvents","selectNewVideo","e","preventDefault","$target","currentTarget","id","data","$selectedThumb","setMainVideo","setActiveThumb","removeClass","addClass","bind","index","element","$el","daysAvailable","str","strArray","catArr","j","match","split","push","searchStringInArray","jsContext","fulfillmentAvailability","unavailable","map","day","querySelector","datepicker","beforeShowDay","date","getDay","minDate","maxDate","dateFormat","insertAdjacentHTML"],"mappings":"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","file":"theme-bundle.chunk.2.js","sourcesContent":["/*\n Import all product specific js\n */\nimport PageManager from \"./page-manager\";\nimport Review from \"./product/reviews\";\nimport collapsibleFactory from \"./common/collapsible\";\nimport ProductDetails from \"./common/product-details\";\nimport videoGallery from \"./product/video-gallery\";\nimport { classifyForm } from \"./common/utils/form-utils\";\nimport modalFactory from \"./global/modal\";\n\nimport FulfillmentDatepicker from \"./fulfillment-datepicker\";\n\nexport default class Product extends PageManager {\n  constructor(context) {\n    super(context);\n    this.url = window.location.href;\n    this.$reviewLink = $('[data-reveal-id=\"modal-review-form\"]');\n    this.$bulkPricingLink = $('[data-reveal-id=\"modal-bulk-pricing\"]');\n    this.reviewModal = modalFactory(\"#modal-review-form\")[0];\n  }\n\n  onReady() {\n    setTimeout(() => {\n      FulfillmentDatepicker();\n    }, 0);\n    // Listen for foundation modal close events to sanitize URL after review.\n    $(document).on(\"close.fndtn.reveal\", () => {\n      if (\n        this.url.indexOf(\"#write_review\") !== -1 &&\n        typeof window.history.replaceState === \"function\"\n      ) {\n        window.history.replaceState(\n          null,\n          document.title,\n          window.location.pathname\n        );\n      }\n    });\n\n    let validator;\n\n    // Init collapsible\n    collapsibleFactory();\n\n    this.productDetails = new ProductDetails(\n      $(\".productView\"),\n      this.context,\n      window.BCData.product_attributes\n    );\n    this.productDetails.setProductVariant();\n\n    videoGallery();\n\n    this.bulkPricingHandler();\n\n    const $reviewForm = classifyForm(\".writeReview-form\");\n\n    if ($reviewForm.length === 0) return;\n\n    const review = new Review({ $reviewForm });\n\n    $(\"body\").on(\"click\", '[data-reveal-id=\"modal-review-form\"]', () => {\n      validator = review.registerValidation(this.context);\n      this.ariaDescribeReviewInputs($reviewForm);\n    });\n\n    $reviewForm.on(\"submit\", () => {\n      if (validator) {\n        validator.performCheck();\n        return validator.areAll(\"valid\");\n      }\n\n      return false;\n    });\n\n    this.productReviewHandler();\n  }\n\n  ariaDescribeReviewInputs($form) {\n    $form.find(\"[data-input]\").each((_, input) => {\n      const $input = $(input);\n      const msgSpanId = `${$input.attr(\"name\")}-msg`;\n\n      $input.siblings(\"span\").attr(\"id\", msgSpanId);\n      $input.attr(\"aria-describedby\", msgSpanId);\n    });\n  }\n\n  productReviewHandler() {\n    if (this.url.indexOf(\"#write_review\") !== -1) {\n      this.$reviewLink.trigger(\"click\");\n    }\n  }\n\n  bulkPricingHandler() {\n    if (this.url.indexOf(\"#bulk_pricing\") !== -1) {\n      this.$bulkPricingLink.trigger(\"click\");\n    }\n  }\n}\n","export class VideoGallery {\n    constructor($element) {\n        this.$player = $element.find('[data-video-player]');\n        this.$videos = $element.find('[data-video-item]');\n        this.currentVideo = {};\n        this.bindEvents();\n    }\n\n    selectNewVideo(e) {\n        e.preventDefault();\n\n        const $target = $(e.currentTarget);\n\n        this.currentVideo = {\n            id: $target.data('videoId'),\n            $selectedThumb: $target,\n        };\n\n        this.setMainVideo();\n        this.setActiveThumb();\n    }\n\n    setMainVideo() {\n        this.$player.attr('src', `//www.youtube.com/embed/${this.currentVideo.id}`);\n    }\n\n    setActiveThumb() {\n        this.$videos.removeClass('is-active');\n        this.currentVideo.$selectedThumb.addClass('is-active');\n    }\n\n    bindEvents() {\n        this.$videos.on('click', this.selectNewVideo.bind(this));\n    }\n}\n\nexport default function videoGallery() {\n    const pluginKey = 'video-gallery';\n    const $videoGallery = $(`[data-${pluginKey}]`);\n\n    $videoGallery.each((index, element) => {\n        const $el = $(element);\n        const isInitialized = $el.data(pluginKey) instanceof VideoGallery;\n\n        if (isInitialized) {\n            return;\n        }\n\n        $el.data(pluginKey, new VideoGallery($el));\n    });\n}\n","import $ from \"jquery\";\nimport \"jquery-ui/ui/core\";\nimport \"jquery-ui/ui/widgets/datepicker\";\n\nexport default function FulfillmentDatepicker() {\n  var daysAvailable = searchStringInArray(\n    \"/\",\n    jsContext.fulfillmentAvailability\n  );\n  var categoryDateMapping = [\n    \"Sunday\",\n    \"Monday\",\n    \"Tuesday\",\n    \"Wednesday\",\n    \"Thursday\",\n    \"Friday\",\n    \"Saturday\",\n  ];\n\n  // loop through categories and create a list of dates that the product is not available\n  var unavailable = categoryDateMapping.map((day, index) => {\n    if (daysAvailable.indexOf(day) == -1) {\n      return index;\n    } else {\n      return false;\n    }\n  });\n\n  // parse category strings\n  function searchStringInArray(str, strArray) {\n    var catArr = [];\n    for (var j = 0; j < strArray.length; j++) {\n      if (strArray[j].match(str)) {\n        var split = strArray[j].split(\"/\");\n        catArr.push(split[1]);\n      }\n    }\n    return catArr;\n  }\n\n  // called from datepicker - loops through calendar dates and disable unavailable dates\n  function handleAvailability(date) {\n    if (daysAvailable.indexOf(\"Everyday\") > -1 && date.getDay() !== 0) {\n      return [true, \"\", \"\"];\n    }\n    if (unavailable.indexOf(date.getDay()) > -1) {\n      return [false, \"unavailable\", \"Unavailable for fulfillment this day\"];\n    } else {\n      return [true, \"\", \"\"];\n    }\n  }\n\n  if (\n    document.querySelector('div[data-product-option-change] input[type=\"text\"]')\n  ) {\n    $('div[data-product-option-change] input[type=\"text\"]').datepicker({\n      beforeShowDay: handleAvailability,\n      minDate: +1,\n      maxDate: \"+6m\",\n      dateFormat: \"DD, MM d\",\n    });\n\n    // create and append calendar icon\n    if (document.querySelector(\"input.hasDatepicker\")) {\n      var insertRef = document.querySelector(\"input.hasDatepicker\");\n      insertRef.insertAdjacentHTML(\n        \"beforebegin\",\n        \"<div class='calendar-icon'><div>\"\n      );\n    }\n  }\n}\n"],"sourceRoot":""}